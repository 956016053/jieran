<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>ç»µç»µé¢˜åº“ç”Ÿæˆå™¨ (Excelè½¬JSON)</title>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #f0f2f5; color: #333; }
        .container { max-width: 1000px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        h1 { color: #4facfe; margin-top: 0; }
        .step { margin-bottom: 20px; padding: 15px; background: #f9f9f9; border-left: 4px solid #4facfe; border-radius: 4px; }
        textarea { width: 100%; height: 150px; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-family: monospace; white-space: pre; overflow-x: auto; }
        button { background: #4facfe; color: white; border: none; padding: 10px 25px; font-size: 16px; border-radius: 5px; cursor: pointer; margin-top: 10px; }
        button:hover { background: #00f2fe; }
        pre { background: #282c34; color: #abb2bf; padding: 15px; border-radius: 5px; overflow-x: auto; position: relative; }
        .copy-btn { position: absolute; top: 10px; right: 10px; background: rgba(255,255,255,0.2); padding: 5px 10px; font-size: 12px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 0.9rem; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background: #eee; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ› ï¸ é¢˜åº“ç”Ÿæˆå·¥å‚</h1>
    
    <div class="step">
        <h3>ç¬¬ä¸€æ­¥ï¼šåœ¨ Excel ä¸­å‡†å¤‡æ•°æ®</h3>
        <p>è¯·ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹åˆ—é¡ºåºæ•´ç†é¢˜ç›®ï¼ˆä¸è¦å¸¦è¡¨å¤´ï¼‰ï¼š</p>
        <table>
            <thead>
                <tr>
                    <th>ç±»å‹ (choice/fill/qa)</th>
                    <th>é¢˜ç›®å†…å®¹</th>
                    <th>é€‰é¡¹ (ä»…é€‰æ‹©é¢˜, ç”¨ | åˆ†éš”)</th>
                    <th>ç­”æ¡ˆ (ç´¢å¼•/æ–‡å­—)</th>
                    <th>æç¤º</th>
                    <th>è§£æ</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>choice</td>
                    <td>1+1ç­‰äºå‡ ?</td>
                    <td>1|2|3|4</td>
                    <td>1</td>
                    <td>ç®€å•æ•°å­¦</td>
                    <td>1+1=2</td>
                </tr>
                <tr>
                    <td>fill</td>
                    <td>AIçš„å…¨ç§°æ˜¯___</td>
                    <td>(ç•™ç©º)</td>
                    <td>Artificial Intelligence</td>
                    <td>è‹±æ–‡</td>
                    <td>åŸºç¡€å®šä¹‰</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="step">
        <h3>ç¬¬äºŒæ­¥ï¼šå¤åˆ¶ Excel å†…å®¹å¹¶ç²˜è´´åˆ°è¿™é‡Œ</h3>
        <textarea id="excelInput" placeholder="ç›´æ¥ä» Excel é€‰ä¸­åŒºåŸŸï¼ŒCtrl+Cï¼Œç„¶ååœ¨è¿™é‡Œ Ctrl+V"></textarea>
        <button onclick="convert()">âš¡ å¼€å§‹è½¬æ¢</button>
    </div>

    <div class="step">
        <h3>ç¬¬ä¸‰æ­¥ï¼šè·å–ç»“æœ</h3>
        <p>å°†ä¸‹æ–¹ä»£ç å¤åˆ¶å¹¶ä¿å­˜ä¸º <code>subject.js</code> æ–‡ä»¶ï¼ˆä¾‹å¦‚ <code>math.js</code>ï¼‰ï¼Œæ”¾å…¥ <code>banks</code> æ–‡ä»¶å¤¹ã€‚</p>
        <pre><button class="copy-btn" onclick="copyCode()">å¤åˆ¶</button><code id="outputCode">// ç­‰å¾…ç”Ÿæˆ...</code></pre>
    </div>
</div>

<script>
function convert() {
    const raw = document.getElementById('excelInput').value.trim();
    if(!raw) return alert("è¯·å…ˆç²˜è´´å†…å®¹ï¼");

    const rows = raw.split('\n');
    const result = [];

    rows.forEach((row, index) => {
        // Excel å¤åˆ¶è¿‡æ¥é€šå¸¸æ˜¯åˆ¶è¡¨ç¬¦(\t)åˆ†éš”
        let cols = row.split('\t');
        
        // å®¹é”™ï¼šå¦‚æœç”¨æˆ·ä»ç½‘é¡µè¡¨æ ¼å¤åˆ¶ï¼Œå¯èƒ½æ˜¯ç©ºæ ¼åˆ†éš”ï¼Œè¿™é‡Œä¸»è¦å¤„ç† Tab
        if(cols.length < 2) return; 

        // æ˜ å°„æ•°æ® (Excelåˆ— -> JSONå­—æ®µ)
        // 0:type, 1:question, 2:options, 3:answer, 4:hint, 5:explanation
        
        let type = (cols[0] || 'choice').trim();
        let qObj = {
            id: `Q-${Date.now()}-${index}`, // è‡ªåŠ¨ç”ŸæˆID
            type: type,
            question: (cols[1] || '').trim(),
            hint: (cols[4] || 'æ— æç¤º').trim(),
            explanation: (cols[5] || 'æš‚æ— è§£æ').trim()
        };

        // å¤„ç†ç‰¹å¼‚æ€§å­—æ®µ
        if(type === 'choice') {
            // å¤„ç†é€‰é¡¹ï¼š "A|B|C|D" -> ["A", "B", "C", "D"]
            qObj.options = (cols[2] || '').split('|').map(o => o.trim());
            // å¤„ç†ç­”æ¡ˆï¼šå¦‚æœæ˜¯æ•°å­— "1"ï¼Œè½¬ä¸ºæ•´æ•°ï¼›å¦‚æœæ˜¯å­—æ¯ç´¢å¼•éœ€å¦å¤–å¤„ç†
            qObj.answer = parseInt(cols[3]) || 0; 
        } else {
            // å¡«ç©ºå’Œç®€ç­”ï¼Œç­”æ¡ˆå°±æ˜¯å­—ç¬¦ä¸²
            qObj.answer = (cols[3] || '').trim();
            // å¦‚æœå¡«ç©ºé¢˜ç­”æ¡ˆæœ‰å¤šä¸ªå¯èƒ½ï¼Œå¯ä»¥åœ¨ Excel ç”¨ | åˆ†éš”ï¼Œè¿™é‡Œè½¬æ•°ç»„
            if(type === 'fill' && qObj.answer.includes('|')) {
                qObj.answer = qObj.answer.split('|');
            }
        }

        result.push(qObj);
    });

    const finalCode = `/* ç”Ÿæˆæ—¶é—´: ${new Date().toLocaleString()} */\nwindow.QuestionBank = ${JSON.stringify(result, null, 4)};`;
    document.getElementById('outputCode').innerText = finalCode;
}

function copyCode() {
    const text = document.getElementById('outputCode').innerText;
    navigator.clipboard.writeText(text).then(() => alert("âœ… ä»£ç å·²å¤åˆ¶ï¼"));
}
</script>

</body>
</html>